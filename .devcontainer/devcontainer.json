{
    "name": "Dolibarr Development Environment",
    "dockerComposeFile": [
        "../images/22.0.1-php8.2-devcontainer/docker-compose.yml"
    ],
    "service": "dolibarr-dev",
    "workspaceFolder": "/var/www/html",
    "shutdownAction": "stopCompose",
    
    "customizations": {
        "vscode": {
            "extensions": [
                // PHP Development
                "xdebug.php-debug",
                "bmewburn.vscode-intelephense-client",
                "MehediDracula.php-namespace-resolver",
                "rifi2k.format-html-in-php",
                
                // Code Quality & Standards
                "ikappas.phpcs",
                "junstyle.php-cs-fixer",
                "phpstan.vscode-phpstan",
                "sanderronde.phpstan-vscode",
                
                // Testing
                "recca0120.vscode-phpunit",
                
                // Git & Version Control
                "eamodio.gitlens",
                "mhutchie.git-graph",
                "GitHub.vscode-pull-request-github",
                "GitHub.copilot",
                
                // Database
                "mtxr.sqltools",
                "mtxr.sqltools-driver-mysql",
                
                // Web Development
                "ms-vscode.vscode-json",
                "redhat.vscode-yaml",
                "bradlc.vscode-tailwindcss",
                
                // Documentation
                "yzhang.markdown-all-in-one",
                "DavidAnson.vscode-markdownlint",
                
                // Utilities
                "aaron-bond.better-comments",
                "PKief.material-icon-theme",
                "streetsidesoftware.code-spell-checker",
                "formulahendry.auto-rename-tag",
                "christian-kohler.path-intellisense"
            ],
            
            "settings": {
                // PHP Configuration
                "php.validate.executablePath": "/usr/local/bin/php",
                "php.debug.executablePath": "/usr/local/bin/php",
                "php.executablePath": "/usr/local/bin/php",
                
                // Intelephense Configuration
                "intelephense.files.maxSize": 5000000,
                "intelephense.completion.insertUseDeclaration": true,
                "intelephense.completion.fullyQualifyGlobalConstantsAndFunctions": false,
                "intelephense.format.enable": true,
                "intelephense.stubs": [
                    "apache", "bcmath", "bz2", "calendar", "com_dotnet", "Core", "ctype", 
                    "curl", "date", "dba", "dom", "enchant", "exif", "FFI", "fileinfo", 
                    "filter", "fpm", "ftp", "gd", "gettext", "gmp", "hash", "iconv", 
                    "imap", "intl", "json", "ldap", "libxml", "mbstring", "meta", 
                    "mysqli", "oci8", "odbc", "openssl", "pcntl", "pcre", "PDO", 
                    "pdo_ibm", "pdo_mysql", "pdo_pgsql", "pdo_sqlite", "pgsql", 
                    "Phar", "posix", "pspell", "readline", "Reflection", "session", 
                    "shmop", "SimpleXML", "snmp", "soap", "sockets", "sodium", 
                    "SPL", "sqlite3", "standard", "superglobals", "sysvmsg", 
                    "sysvsem", "sysvshm", "tidy", "tokenizer", "xml", "xmlreader", 
                    "xmlrpc", "xmlwriter", "xsl", "Zend OPcache", "zip", "zlib"
                ],
                
                // PHPCS Configuration (Dolibarr Standards)
                "phpcs.enable": true,
                "phpcs.executablePath": "/usr/local/bin/phpcs",
                "phpcs.standard": "/var/www/html/dev/setup/codesniffer/ruleset.xml",
                "phpcs.showWarnings": true,
                "phpcs.showSources": true,
                "phpcs.ignorePatterns": [
                    "*/vendor/*",
                    "*/node_modules/*",
                    "*/includes/*"
                ],
                
                // PHP CS Fixer Configuration
                "php-cs-fixer.executablePath": "/usr/local/bin/php-cs-fixer",
                "php-cs-fixer.rules": "@PSR12",
                "php-cs-fixer.formatHtml": true,
                "php-cs-fixer.documentFormattingProvider": true,
                "php-cs-fixer.allowRisky": false,
                
                // PHPStan Configuration
                "phpstan.enabled": true,
                "phpstan.path": "/usr/local/bin/phpstan",
                "phpstan.level": "5",
                "phpstan.configPath": "/var/www/html/dev/setup/phpstan/phpstan.neon",
                
                // PHPUnit Configuration
                "phpunit.php": "/usr/local/bin/php",
                "phpunit.phpunit": "/usr/local/bin/phpunit",
                "phpunit.args": [
                    "--configuration", "/var/www/html/phpunit.xml"
                ],
                
                // File Associations
                "files.associations": {
                    "*.php": "php",
                    "*.inc": "php",
                    "*.tpl": "php",
                    "*.lib": "php",
                    "*.class.php": "php"
                },
                
                // Files to Exclude from Explorer
                "files.exclude": {
                    "**/vendor/**": true,
                    "**/node_modules/**": true,
                    "**/.git/objects/**": true,
                    "**/.git/subtree-cache/**": true,
                    "**/documents/**": true,
                    "**/.DS_Store": true
                },
                
                // Search Exclusions
                "search.exclude": {
                    "**/vendor/**": true,
                    "**/node_modules/**": true,
                    "**/documents/**": true,
                    "**/.git/**": true
                },
                
                // Editor Settings (Following Dolibarr Guidelines)
                "editor.tabSize": 4,
                "editor.insertSpaces": false,
                "editor.detectIndentation": false,
                "editor.trimAutoWhitespace": true,
                "editor.formatOnSave": true,
                "editor.formatOnPaste": false,
                "editor.rulers": [120, 1000],
                
                // Line Endings (Unix format as required by Dolibarr)
                "files.eol": "\n",
                "files.trimTrailingWhitespace": true,
                "files.insertFinalNewline": true,
                "files.trimFinalNewlines": true,
                
                // Git Configuration
                "git.autofetch": true,
                "git.enableSmartCommit": true,
                "git.confirmSync": false,
                "git.defaultCloneDirectory": "/workspace/dolibarr",
                
                // Terminal Configuration
                "terminal.integrated.defaultProfile.linux": "bash",
                "terminal.integrated.cwd": "/var/www/html",
                
                // Docker Integration
                "docker.attachShellCommand.linuxContainer": "/bin/bash",
                
                // Workspace Trust
                "security.workspace.trust.untrustedFiles": "open",
                
                // Performance
                "extensions.ignoreRecommendations": false,
                "workbench.settings.enableNaturalLanguageSearch": false,
                
                // Theme and appearance
                "workbench.colorTheme": "Default Dark Modern",
                "workbench.iconTheme": "material-icon-theme",
                "workbench.startupEditor": "readme"
            }
        }
    },
    
    // Forward ports for development services
    "forwardPorts": [
        8080,  // Dolibarr application
        8081,  // phpMyAdmin
        8025,  // MailHog web UI
        3306,  // MySQL/MariaDB
        9003   // Xdebug
    ],
    
    "portsAttributes": {
        "8080": {
            "label": "Dolibarr Application",
            "onAutoForward": "openBrowser"
        },
        "8081": {
            "label": "phpMyAdmin"
        },
        "8025": {
            "label": "MailHog (Email Testing)"
        },
        "3306": {
            "label": "MariaDB"
        },
        "9003": {
            "label": "Xdebug"
        }
    },
    
    // Container configuration
    "remoteUser": "www-data",
    "updateRemoteUserUID": false,
    "overrideCommand": false,
    
    // Post-creation commands
    "postCreateCommand": "echo 'ðŸŽ‰ Dolibarr Development Environment Ready! Use dolibarr-dev command for helpers.'",
    
    // Lifecycle scripts
    "initializeCommand": "echo 'Initializing Dolibarr development environment...'",
    "onCreateCommand": "echo 'Creating development environment...'",
    
    // Mount the Docker socket for Docker-in-Docker scenarios
    "mounts": [
        "source=/var/run/docker.sock,target=/var/run/docker.sock,type=bind,consistency=cached"
    ],
    
    // Features to install
    "features": {
        "ghcr.io/devcontainers/features/git:1": {
            "version": "latest",
            "ppa": true
        },
        "ghcr.io/devcontainers/features/github-cli:1": {
            "version": "latest"
        }
    }
}